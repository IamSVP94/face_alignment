### Задание

Реализация алгоритма обнаружения 68 особых точек на лице человека

Задание заключается в реализации алгоритма обнаружения 68 особых точек на лице человека (face alignment), тестировании
данного алгоритма на общедоступных датасетах и сравнении с аналогами.

Обучающие данные представляют собой разметку 68 точек лица, в формате IBUG (https://ibug.doc.ic.ac.uk/resources/300-W/).
Данные для обучения и тестирования можно найти по
ссылке https://drive.google.com/file/d/0B8okgV6zu3CCWlU3b3p4bmJSVUU/view?usp=sharing. Предоставленные данные состоят из
датасетов 300W и Menpo, на тестовой части которых (папки test) нужно замерить точность работы обученной модели.
Обучающие данные можно использовать любые, например можно взять train часть 300W и Menpo датасетов (из Menpo нужно
выкинуть профильные изображения, на которых размечено только 39 точек).

В качестве прямоугольника лица нужно использовать прямоугольник, выдаваемый детектором лиц из библиотеки
DLIB (https://github.com/davisking/dlib/blob/master/python_examples/face_detector.py). При необходимости ограничивающий
прямоугольник из dlib можно модифицировать.

За основу алгоритма можно (но не обязательно) взять архитектуру нейронной сети, описанной в статье "Joint Face Detection
and Alignment using Multi-task Cascaded Convolutional Networks" (https://arxiv.org/pdf/1604.02878.pdf, сеть ONet,
fig.2), оставив в функции потерь только член, отвечающий за особые точки лица.

#### В отчёте по результатам выполнения тестового задания должны быть:

- [x] код для обучения и тестирования модели

- [x] скрипт, позволяющий минимальными усилиями воспроизвести результат (запустить обучение и тестирование) и
  документация к нему

- [ ] отчёт в формате pdf с описанием проделанных экспериментов (какие подходы были проверены, какие результаты и выводы
  были сделаны и т.д.). В отчёте помимо описания проделанных экспериментов нужно вставить графики по метрике CED (
  cummulative error distribution), по оси X в которых идёт нормированная среднеквадратичная ошибка, а по оси Y - процент
  изображений в тестовой выборке, ошибка на которых меньше значения по оси X. Максимальное значение ошибки по оси X
  взять равным 0.08. Нормализацию ошибки нужно производить на величину sqrt(H * W), где H, W - высота и ширина
  прямоугольника лица, полученного с помощью DLIB. Ошибку нужно считать в координатах исходного изображения. Для каждого
  графика CED необходимо посчитать площадь под кривой - это будет целевая метрика для сравнения алгоритмов. Графики CED
  должны быть построены отдельно для датасетов 300W и Menpo. Помимо предложенного метода нужно отобразить на графике
  точность работы детектора точек DLIB для базы Menpo (детектор dlib обучался на базе 300W, поэтому тестировать dlib на
  ней не имеет смысла).

Пример использования :
http://dlib.net/face_landmark_detection.py.html

<p>Пример скрипта для подсчёта CED графиков можно найти тут:
https://drive.google.com/file/d/0B8okgV6zu3CCTk96SW9IWFJ6RE0/view?usp=sharing
Минимальный результат - предложенный алгоритм должен быть близок к DLIB по площади под CED графиком при пороге 0.08.</p>

---

Инструкция по работе с репозиторием: https://github.com/IamSVP94/face_alignment/blob/main/instruction.md

Отчет: https://github.com/IamSVP94/face_alignment/blob/main/report.pdf

Обученый чекпоинт pt_lightning, с которого фиксировались результаты для оценки метрик: https://drive.google.com/file/d/1zobzn5hBOLYGm2F81lbDGCEqcl5LtG31/view?usp=sharing

---